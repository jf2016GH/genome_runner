<!DOCTYPE html>
<html lang="en">
	<head>
		% if status != "Analysis Completed" and not "Run crashed." in status:
		<meta http-equiv="refresh" content="10">
		% endif
		<style>
			body {
				padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
			}
			/* allows the check box tree to be rendered correctly*/
			.ui-icon {float: left;}
			div.tooltip {   
			  position: absolute;           
			  text-align: center;           
			  width: 260px;                  
			  height: 50px;                 
			  padding: 2px;             
			  font: 12px sans-serif;        
			  background: #1C1C1C;   
			  border: 0px;      
			  border-radius: 8px;           
			  pointer-events: none;         
			}
		</style>

		<!-- For IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<link href="static/css/bootstrap.min.css" rel="stylesheet">
		<link type="text/css" href="static/css/ui-lightness/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
		<link type="text/css" href="static/css/main.css"/>
		<script type="text/javascript" src="static/js/jquery.js"></script>
		<script type="text/javascript" src="static/jui/jquery-ui-1.8.12.custom/js/jquery-ui-1.8.12.custom.min.js"></script>
		<script src="static/js/bootstrap.min.js"></script>
		<script src="static/js/bootstrap-tabs.js"></script>
		<script scr="static/js/main.js"></script>
		<script src='http://documentcloud.github.com/underscore/underscore.js'></script>
      	<script src='http://documentcloud.github.com/backbone/backbone.js'></script>
      	<script src='http://mbostock.github.com/d3/d3.js'></script>
		<script type="text/javascript" charset="utf-8">
		$(document).ready(function() {
			$("#progressbar").progressbar({
								value: ${curprog},
								max:  ${progmax}
							});
			matrix_data  = "${matrix_data}";
			matrix_gfs = "${matrix_gfs}";
			matrix_fois = "${matrix_fois}";
			matrix_cor = "${matrix_cor}";
			matrix_cor_rownames = "${matrix_cor_rownames}";
			matrix_cor_colnames = "${matrix_cor_colnames}";	
			matrix_cor_pvalues = "${matrix_cor_pvalues}";		

		});
		</script>
      	<script src='static/js/d3.heatmap.js' type="text/javascript"></script>
		
</head>
<body bgcolor="#A8D5FF">	
	<div class="topbar">
		<div class="topbar-inner">
			<div class="container-fluid">
				<a class="brand" href="./" style="font-family:Futura,'Helvetica Neue', Arial">
					<img width="200px" src="static/images/GRLogo.png" />
				</a>
				<ul class="pull-right">
					<li><a href="./overview">Overview</a></li>
					<li><a href="./news">News</a></li>
					<li><a href="./">Use GenomeRunner</a></li>
					<li><a href="./demo">Demo</a></li>
					<li><a href="./cite">How to Cite</a></li>
				</ul>
			</div>
		</div>
	</div>
<div class="well">
	<div style="margin: 10px;margin-top:70px;">
	<div id="progressbar" ></div>
	<div class="ui-widget" style="">
		<div class="ui-state-highlight ui-corner-all">
			<p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span>${status}</p>
		</div>
	</div>
	% if zipfile != "":
	<a class="btn btn-primary" type="button" href="${zipfile}">Download all run files</a>
	% else:
	<a class="btn btn-primary disabled" type="button">Run files not ready for download</a>
	% endif
</div>
</div>
<ul class="tabs" id="resultstab" data-tabs="tabs">
	<li class="active" ><a href="#matrixresults" onclick="change_active_heatmap('heatmap')">Clustered Enrichment Matrix</a></li>
	<li ><a href="#cormatrixresults" onclick="change_active_heatmap('heatmap_cor')">Pearson's Correlation Matrix Results</a></li>
	<li ><a href="#detailedresults">Detailed Results</a></li>
	<li ><a href="#debugresults">Analysis Log</a></li>
	<li ><a href="#heatmapdownload">Download Matrices</a></li>
</ul>

<div class="pill-content">
	<div class="active" id="matrixresults">
		<div class="well">
			<h3 style="float: left">Clustered Heatmap</h3>			
				<a id="heatmap_download" class="btn btn-primary" style="margin-left: 20px; margin-top: 3px">Download Heatmap (Right click - 'Save As' to save)</a>
				<div  id='heatmap' >
	      		</div>
	      		<h3>Raw Unclustered Matrix Data</h3>
				<textarea cols="150" rows="30">${matrix}</textarea><br>
			</div>

		</div>

	<div id="cormatrixresults">
		<div class="well">
			<h3 style="float: left">Clustered Heatmap</h3>		
			<a id="heatmap_cor_download" class="btn btn-primary" style="margin-left: 20px; margin-top: 3px">Download Heatmap (Right click - 'Save As' to save)</a>
			<div  id='heatmap_cor' >
      		</div>
      		<h3>Raw Unclustered Matrix Data</h3>
			<textarea cols="150" rows="30">${matrix_cor_data}</textarea><br>
		</div>
	</div>
	<div id="detailedresults">
		<div class="well">
			<h3>Detailed Results</h3>
			<textarea cols="150" rows="30">${detailed}</textarea><br>			
		</div>
	</div>
	<div id="debugresults">
		<div class="well">
			<h3>Analysis Log</h3>
			<textarea cols="150" rows="30">${log}</textarea><br>
		</div>
	</div>
	<div id="heatmapdownload">
		<div class="well">
			<h3>Right click the images and choose 'Save As'</h3>
			<h4>Enrichment Matrix</h4>
			<div id="heatmap3_download" >
			</div>
			<h4>Pearson's Correlation Matrix</h4>
		</div>
	</div>
</div>

</body>
</html>
