<html>
	<head>
		<style type="text/css" title="currentStyle">
			@import "static/css/demo_page.css";
			@import "static/css/jquery.dataTables.css";
			@import "static/css/demo_table.css";
			@import "static/css/TableTools.css";
			@import "static/css/TableTools_JUI.css";
			.chart rect {
					stroke: white;
					fill: steelblue;
				}
		</style>
		<script type="text/javascript" 
			language="javascript" src="static/js/jquery.js"></script>
		<script type="text/javascript" language="javascript"
			src="static/js/jquery.dataTables.js"></script>
		<script type="text/javascript" language="javascript"
			src="static/js/TableTools.js"></script>
		<script type="text/javascript" language="javascript"
			src="static/js/ZeroClipboard.js"></script>
		<script type="text/javascript" charset="utf-8">
			$(document).ready(function() {
				$('#tbl').dataTable({
					"sDom": 'T<"clear">lfrtip',
					"oTableTools": {
						"sSwfPath": "static/swf/copy_csv_xls_pdf.swf"
					}
				});
				var columns = $('#tbl thead th').map(function(){
					return $(this).attr('value');
					});
				var tableObject = $('#tbl tbody tr').map(function(i) {
					var row = {};
					$(this).find('td')`
			} );
		</script>
	</head>
	<body>
		<table id="tbl" class="display" cellpadding="0"
			cellspacing="0" border="0">
			<thead>
				<tr>
					<th value="gfname">GF Name</th>
					<th value="numfoi">#FOIs</th>
					<th value="numgf">#Genomic Features</th>
					<th value="obsoverlap">#Overlaps (observed)</th>
					<th value="expoverlap">#Overlaps (expected)</th>
					<th value="pybed_expoverlap">#overlaps (PyBed expected)</th>
					<th value="pvalue">P-value</th>
					<th value="pybed_p_value">PyBed P-value</th>
					<th value="obsprox">Proximety to GF (observed)</th>
					<th value="expprox">Proximety to GF (expected)</th>
					
				</tr>
			</thead>
			<tbody>

				% for i,e in enumerate(enrichments):
					
					<tr class="${e.category()}">
						<td>${e.B}</td>
						<td>${e.nA}</td>
						<td>${e.nB}</td>
						<td>${e.observed}</td>
						<td>${e.expected}</td>
						<td>${e.pybed_expected}</td>
						<td>${e.p_value}</td>
						<td>${e.pybed_p_value}</td>
						<td>${e.obsprox}</td>
						<td>${e.expprox}</td>
					</tr>
				% endfor
			</tbody>
		</table>
				<h2><a href="/gr">GO BACK</a></h2>
		<h2>Data Visulization</h2>
		<div id="rect-demo"></div>
		<script src="static/js/d3.js"></script>
		<script>
			var td = [{gfname: "gf1",pvalue: 0.01, obsoverlap: 100, expoverlap: 150},
					{gfname: "gf2", pvalue: 0.003, obsoverlap: 100, expoverlap: 10},
					{gfname: "gf3", pvalue: 0.06, obsoverlap: 100, expoverlap: 120},
					{gfname: "gf4", pvalue: 0.08, obsoverlap: 100, expoverlap: 155}];
				
			var barWidth = 40
			var width = (barWidth + 10) * td.length;
			var height = 200;
			var pvmin = d3.min(td,function(d) { return d.pvalue;});
			var pvmax = d3.max(td,function(d) { return d.pvalue});
			var fillover  = d3.scale.ordinal()
			.domain([pvmin,pvmax])
			.range(["#000000","#FFDD89","957244","F26223"])
			
			var fillunder  = d3.scale.ordinal()
			.domain([pvmin,pvmax])
			.range(["#000000","#FFDD89","957244","F26223"])

				
			var barDemo  = d3.select("#rect-demo").
			append("svg:svg")
			.attr("width",width)
			.attr("height",height);

			var x = d3.scale.linear().domain([0, td.length]).range([0,width]);
			var y = d3.scale.linear().domain([0,d3.max(td, function(d) { return d.pvalue;})])
			.rangeRound([0,height]);
			
			barDemo.selectAll("rect").
				data(td).
				enter().
				append("svg:rect").
				attr("x", function(d,i) {return x(i); })
				.attr("y", function(d,i) {return height - y(d.pvalue);})
				.attr("height", function(d) { return y(d.pvalue);})
				.attr("width", barWidth)
				.attr("fill", function(d) { return d.expoverlap < d.obsoverlap ?  d.fillover(d.pvalue) : d.fillunder(d.pvalue);});


		</script>

	</body>
</html>

