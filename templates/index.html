<!DOCTYPE html>
<html lang="en">
	<head>
		<link href="static/css/bootstrap.css" rel="stylesheet">
		<style>
			body {
				padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
			}
			/* allows the check box tree to be rendered correctly*/
			.ui-icon {float: left;}
		</style>

		<!-- For IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<link type="text/css" href="static/css/ui-lightness/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
		<link type="text/css" href="static/css/main.css"/>
		<script type="text/javascript" src="static/js/jquery.js"></script>
		<script type="text/javascript" src="static/jui/jquery-ui-1.8.12.custom/js/jquery-ui-1.8.12.custom.min.js"></script>
		<script type="text/javascript" src="static/js/jquery-ui-1.8.22.custom.min.js"></script>
		<script type="text/javascript" src="static/js/jquery.ui.widget.js"></script>
		<script type="text/javascript" src="static/js/jquery.checkboxtree.js"></script>
		<script src="static/js/fcbkcomplete.min.js" type="text/javascript" charset="utf-8"></script>
		<!-- File input -->
		<script src="static/js/enhance.min.js"i type="text/javascript"></script>
		<script src="static/js/jquery.fileinput.js" type="text/javascript"></script>
		<link type="text/css" href="static/css/jqury.ui.fileinput.css"></link>

		<link rel="stylesheet" href="static/css/combobox.css" type="text/css" media="screen" title="Test Stylesheet" charset="utf-8" />
		<script src="static/js/bootstrap.js"></script>
		<script scr="static/js/main.js"></script>

		<script type="text/javascript">
			function getQueryVariable(variable) { 
				var query = window.location.search.substring(1); 
				var vars = query.split("&"); 
				for (var i = 0; i < vars.length; i++) { 
					var pair = vars[i].split("="); 
					if (pair[0] == variable) { 
						return pair[1]; 
					} 
				} 
				return null; 
			} 

$(document).ready(function() {
		$('#ucsc').checkboxTree({
initializeChecked: 'collapsed',
initializeUnchecked: 'collapsed'
});

		$('#org').change(function() {;
			var org = document.getElementById("org").value;
			var temp = org.split(":");
			var $url="index?organism=" + temp[1];
			window.location = $url;
			})
		if (getQueryVariable('organism') != null){
		$('#org').val("organism:" + getQueryVariable('organism'));
		}
		else{
		$('#org').val("organism:hg19");
		}

		$.facebooklist('#gfs', '#preadded', '#grfs-auto',{url:'static/gfs.php',cache:1}, 10, {userfilter:1,casesensetive:0});

$('input:submit').button();


});

function switchinput(checked){
	if (checked == "bedfile"){
		document.getElementById("inputbedfile").disabled=false;
		document.getElementById("inputbeddata").disabled=true;
		document.getElementById("inputbeddata").text = ""
			document.getElementById("inputbeddata").value = ""
	}
	else {
		document.getElementById("inputbedfile").disabled=true;
		document.getElementById("inputbeddata").disabled=false;
		document.getElementById("inputbeddata").text = ""
			document.getElementById("inputbeddata").value = ""
	}
}

function switchbackgroundinput(checked){
	if (checked == "backgroundfile"){
		document.getElementById("inputbackgroundfile").disabled=false;
		document.getElementById("inputbackgrounddata").disabled=true;
		document.getElementById("inputbackgrounddata").text = ""
			document.getElementById("inputbackgrounddata").value = ""
	}
	else {
		document.getElementById("inputbackgroundfile").disabled=true;
		document.getElementById("inputbackgrounddata").disabled=false;
		document.getElementById("inputbackgrounddata").text = ""
			document.getElementById("inputbackgrounddata").value = ""
	}
}

//prevents user from submitting form by accidentally pressing the enter key
function stopRKey(evt) { 
	var evt = (evt) ? evt : ((event) ? event : null); 
	var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null); 
	if ((evt.keyCode == 13) && (node.type=="text"))  {return false;} 
} 

document.onkeypress = stopRKey; 

</script>
</head>
<body bgcolor="#A8D5FF">

	<div class="topbar">
		<div class="topbar-inner">
			<div class="container-fluid">
				<a class="brand" href="./" style="font-family:Futura,'Helvetica Neue', Arial">
					<img width="200px" src="static/images/GRLogo.png" />
				</a>
				<ul class="pull-right">
					<li><a href="#overview">Overview</a></li>
					<li><a href="#news">News</a></li>
					<li><a href="#UseGenomeRunner">Use GenomeRunner</a></li>
					<li><a href="#demo">Demo</a></li>
					<li><a href="#howtocite">How to Cite</a></li>
				</ul>
			</div>
		</div>
	</div>
	<form action="query" method="post" enctype="multipart/form-data">
		<div class="well">
			<b>Organism</b>
			${paths.org_as_html(id="org")}
		</div>
		<div class="well">
			<h3>1. Upload Features of Interest</h3>
			<ul>
				<li>
				<input type="radio" name="rdbed"  checked="checked"  value="bedfile" onclick="switchinput(this.value)"/>
				Bed File:<input type="file" id="inputbedfile" style="margin:5px" name="bed_file" />
				</li>
				<li>
				<span style="margin-right:5px; float: left">
					<input name="rdbed" type="radio" id="bedchoicedata" style="margin:5px" value="beddata" onclick="switchinput(this.value)"/>
				</span>
				<span style="margin-right:5px; float: left">Bed Data:</span>

				<textarea id="inputbeddata" rows=5 cols=200 style="margin:5px" name="bed_data" disabled>
				</textarea>
				</li>
			</ul>
		</div>
		<div class="well">
			<h3>2. Upload a Background (Optional)</h3>
			<ul>
				<li id="list-bedbackground">
				<input type="radio" name="rdbackground"  checked="checked" style="margin:5px" value="backgroundfile" onclick="switchbackgroundinput(this.value)"/>
				Bed File:<input type="file" id="inputbackgroundfile" style="margin:5px" name="background_file" />
				</li>
				<li id="list-background">
				<span style="margin-right:5px; float: left">

					<input name="rdbackground" type="radio" id="bedchoicedata" style="margin:5px" value="backgrounddata" onclick="switchbackgroundinput(this.value)"/>	
				</span>
				<span style="margin-right:5px; float: left">Bed File:</span>
				<textarea id="inputbackgrounddata" rows=5 cols=200 style="margin:5px" name="background_data" disabled>
				</textarea>
				</li>
			</ul>
		</div>
		<div class="well">
			<h3>3. Choose tracks of interest:</h3>
			<div id="grfdroplist">
				<label >Enter track names: </label>
				<ol>        
					<li id="grf-list" class="input-text">
					<input style="float: left;" type="text" value="" id="gfs" class"grf"/>
					</li>
					<div id="grfs-auto">
						<div class="default">Type the names of the GenomeRunner features to run</div> 
						<ul id="feed">
						</ul>
					</div>
				</ol>   
			</div>
			<label >Select track names: </label>
			${paths.as_html(id="ucsc")}
		</div>
		<div class="well">
			<h3>4. Advanced (optional):</h3>
			<b># MC iters:</b>
			<input id="niter"
			type="text" name="niter" value="10"/> <br />
			<b>Score cutoff:</b>
			<input type="text" name="score" /> <br />
			<b>Strand:</b>
			<input checked="yes" 
			type="radio" name="strand" value="" />Any
			<input type="radio" name="strand" value="+" />+
			<input type="radio" name="strand" value="-" />-
			<br />
		</div>
		<div class="well">
			<table class="table table-bordered table-striped">
				<h3>5. Select Tests</h3> 
				<tbody>
					<tr>
						<td>Calculates the P-Value using Monte Carlo and the PyBedTools intersect. Can use custom background</td>
						<td>
							<input type="checkbox" id="chk_pvalue"  name="run:pvalue" checked="checked"/><label for="chk_pvalue">Standard P-Value</label>
						</td>
					</tr>
					<tr>
						<td>Calculates the P-Value using PyBedTools. Ignores custom background</td>
						<td>
							<input type="checkbox" id="chk_pybed"  name="run:pybed" /><label for="chk_pybed">BedTools P-Value</label>
						</td>
					</tr>
					<tr>
						<td>Calculates the P-Value using the Jaccard statistical test. Ignores custom background</td>
						<td>
							<input type="checkbox" id="chk_jaccard" name="run:jaccard" /><label for="chk_jaccard">Jaccard P-Value</label>
						</td>
					</tr>
					<tr>
						<td>Runs a proximity analysis. TEST: currently uses background, are the results as expected? Also calculates a P-Value</td>
						<td>
							<input type="checkbox" id="chk_proximity"  name="run:proximity" /><label for="chk_proximity">Proximity</label>
						</td>
					</tr>
					<tr>
						<td>Calculates a P-Value using the Kolmogorov-Smornov statistical test. Ignores custom background</td>
						<td>
							<input type="checkbox" id="chk_kolmogorov"  name="run:kolmogorov" /><label for="chk_kolmogorov">Kolmogorov-Smornov P-Value</label>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="well">
			<h3>6. Run query!</h3> 
			<ul>
				<li>
				<input id="jobname" name="jobname" type="text" value=""/>
				<label style="float:left; margin: 5px;">Enter a job name (optional):</label>
				</li>
				<li>
				<input class="btn btn-primary" type="submit" / >
				</li>
			</ul>
			<br>
			<div class="ui-state-highlight ui-corner-all">
				<p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;">
				</span>GenomeRunner works best in Chrome or Internet Explorer 9+</p>
			</div>

		</div>
	</form>
</body>
</html>
